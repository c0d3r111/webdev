const e=window.create,t=window.composer,a=t,r={},o={type:[["Select password type"],["Only include letters",1],["Mix numbers and letters",2],["Include special characters",3]],size:[["Select password size"],["8 Characters",8],["10 Characters",10],["12 Characters",12],["14 Characters",14],["16 Characters",16],["18 Characters",18],["20 Characters",20],["24 Characters",24],["32 Characters",32],["56 Characters",56],["64 Characters",64],["96 Characters",96],["128 Characters",128],["196 Characters",196],["256 Characters",256]],questions:["Pick a question","What was your childhood nickname?","What is the full name of your first love?","Who was your first roommate?","What are you most afraid of?","What is the nickname of the person you love most?","What school did you attend for sixth grade","What was your childhood phone number?","What is the company name of your first job?","What is make and model of your first car?"]},s={icons:{get check(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.71,7.21a1,1,0,0,0-1.42,0L9.84,14.67,6.71,11.53A1,1,0,1,0,5.29,13l3.84,3.84a1,1,0,0,0,1.42,0l8.16-8.16A1,1,0,0,0,18.71,7.21Z"/></svg>')},get cog(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 24 24"><path d="M19.9,12.66a1,1,0,0,1,0-1.32L21.18,9.9a1,1,0,0,0,.12-1.17l-2-3.46a1,1,0,0,0-1.07-.48l-1.88.38a1,1,0,0,1-1.15-.66l-.61-1.83A1,1,0,0,0,13.64,2h-4a1,1,0,0,0-1,.68L8.08,4.51a1,1,0,0,1-1.15.66L5,4.79A1,1,0,0,0,4,5.27L2,8.73A1,1,0,0,0,2.1,9.9l1.27,1.44a1,1,0,0,1,0,1.32L2.1,14.1A1,1,0,0,0,2,15.27l2,3.46a1,1,0,0,0,1.07.48l1.88-.38a1,1,0,0,1,1.15.66l.61,1.83a1,1,0,0,0,1,.68h4a1,1,0,0,0,.95-.68l.61-1.83a1,1,0,0,1,1.15-.66l1.88.38a1,1,0,0,0,1.07-.48l2-3.46a1,1,0,0,0-.12-1.17ZM18.41,14l.8.9-1.28,2.22-1.18-.24a3,3,0,0,0-3.45,2L12.92,20H10.36L10,18.86a3,3,0,0,0-3.45-2l-1.18.24L4.07,14.89l.8-.9a3,3,0,0,0,0-4l-.8-.9L5.35,6.89l1.18.24a3,3,0,0,0,3.45-2L10.36,4h2.56l.38,1.14a3,3,0,0,0,3.45,2l1.18-.24,1.28,2.22-.8.9A3,3,0,0,0,18.41,14ZM11.64,8a4,4,0,1,0,4,4A4,4,0,0,0,11.64,8Zm0,6a2,2,0,1,1,2-2A2,2,0,0,1,11.64,14Z"/></svg>')},get copy(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21,8.94a1.31,1.31,0,0,0-.06-.27l0-.09a1.07,1.07,0,0,0-.19-.28h0l-6-6h0a1.07,1.07,0,0,0-.28-.19.32.32,0,0,0-.09,0A.88.88,0,0,0,14.05,2H10A3,3,0,0,0,7,5V6H6A3,3,0,0,0,3,9V19a3,3,0,0,0,3,3h8a3,3,0,0,0,3-3V18h1a3,3,0,0,0,3-3V9S21,9,21,8.94ZM15,5.41,17.59,8H16a1,1,0,0,1-1-1ZM15,19a1,1,0,0,1-1,1H6a1,1,0,0,1-1-1V9A1,1,0,0,1,6,8H7v7a3,3,0,0,0,3,3h5Zm4-4a1,1,0,0,1-1,1H10a1,1,0,0,1-1-1V5a1,1,0,0,1,1-1h3V7a3,3,0,0,0,3,3h3Z"/></svg>')},get direction(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.71,10.21,12,7.91l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-3-3a1,1,0,0,0-1.42,0l-3,3a1,1,0,0,0,1.42,1.42Zm4.58,4.58L12,17.09l-2.29-2.3a1,1,0,0,0-1.42,1.42l3,3a1,1,0,0,0,1.42,0l3-3a1,1,0,0,0-1.42-1.42Z"/></svg>')},get export(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.71,7.71,11,5.41V15a1,1,0,0,0,2,0V5.41l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-4-4a1,1,0,0,0-.33-.21,1,1,0,0,0-.76,0,1,1,0,0,0-.33.21l-4,4A1,1,0,1,0,8.71,7.71ZM21,14a1,1,0,0,0-1,1v4a1,1,0,0,1-1,1H5a1,1,0,0,1-1-1V15a1,1,0,0,0-2,0v4a3,3,0,0,0,3,3H19a3,3,0,0,0,3-3V15A1,1,0,0,0,21,14Z"/></svg>')},get import(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21,14a1,1,0,0,0-1,1v4a1,1,0,0,1-1,1H5a1,1,0,0,1-1-1V15a1,1,0,0,0-2,0v4a3,3,0,0,0,3,3H19a3,3,0,0,0,3-3V15A1,1,0,0,0,21,14Zm-9.71,1.71a1,1,0,0,0,.33.21.94.94,0,0,0,.76,0,1,1,0,0,0,.33-.21l4-4a1,1,0,0,0-1.42-1.42L13,12.59V3a1,1,0,0,0-2,0v9.59l-2.29-2.3a1,1,0,1,0-1.42,1.42Z"/></svg>')},get lock(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17,9V7A5,5,0,0,0,7,7V9a3,3,0,0,0-3,3v7a3,3,0,0,0,3,3H17a3,3,0,0,0,3-3V12A3,3,0,0,0,17,9ZM9,7a3,3,0,0,1,6,0V9H9Zm9,12a1,1,0,0,1-1,1H7a1,1,0,0,1-1-1V12a1,1,0,0,1,1-1H17a1,1,0,0,1,1,1Z"/></svg>')},get logout(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,12a1,1,0,0,0,1,1h7.59l-2.3,2.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0l4-4a1,1,0,0,0,.21-.33,1,1,0,0,0,0-.76,1,1,0,0,0-.21-.33l-4-4a1,1,0,1,0-1.42,1.42L12.59,11H5A1,1,0,0,0,4,12ZM17,2H7A3,3,0,0,0,4,5V8A1,1,0,0,0,6,8V5A1,1,0,0,1,7,4H17a1,1,0,0,1,1,1V19a1,1,0,0,1-1,1H7a1,1,0,0,1-1-1V16a1,1,0,0,0-2,0v3a3,3,0,0,0,3,3H17a3,3,0,0,0,3-3V5A3,3,0,0,0,17,2Z"/></svg>')},get moon(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/></svg>')},get plus(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Zm4-9H13V8a1,1,0,0,0-2,0v3H8a1,1,0,0,0,0,2h3v3a1,1,0,0,0,2,0V13h3a1,1,0,0,0,0-2Z"/></svg>')},get slider(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,8.18V3a1,1,0,0,0-2,0V8.18a3,3,0,0,0,0,5.64V21a1,1,0,0,0,2,0V13.82a3,3,0,0,0,0-5.64ZM19,12a1,1,0,1,1,1-1A1,1,0,0,1,19,12Zm-6,2.18V3a1,1,0,0,0-2,0V14.18a3,3,0,0,0,0,5.64V21a1,1,0,0,0,2,0V19.82a3,3,0,0,0,0-5.64ZM12,18a1,1,0,1,1,1-1A1,1,0,0,1,12,18ZM6,6.18V3A1,1,0,0,0,4,3V6.18a3,3,0,0,0,0,5.64V21a1,1,0,0,0,2,0V11.82A3,3,0,0,0,6,6.18ZM5,10A1,1,0,1,1,6,9,1,1,0,0,1,5,10Z"/></svg>')},get sun(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/></svg>')},get top(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,20H5a1,1,0,0,0,0,2H19a1,1,0,0,0,0-2ZM8.71,7.71,11,5.41V17a1,1,0,0,0,2,0V5.41l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-4-4a1,1,0,0,0-.33-.21,1,1,0,0,0-.76,0,1,1,0,0,0-.33.21l-4,4A1,1,0,1,0,8.71,7.71Z"/></svg>')},get trash(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10,18a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,10,18ZM20,6H16V5a3,3,0,0,0-3-3H11A3,3,0,0,0,8,5V6H4A1,1,0,0,0,4,8H5V19a3,3,0,0,0,3,3h8a3,3,0,0,0,3-3V8h1a1,1,0,0,0,0-2ZM10,5a1,1,0,0,1,1-1h2a1,1,0,0,1,1,1V6H10Zm7,14a1,1,0,0,1-1,1H8a1,1,0,0,1-1-1V8H17Zm-3-1a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,14,18Z"/></svg>')}},get logo(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 344 90"><defs/><path d="M115 45c0-4 1-8 3-11s5-6 8-7l9-3c4 0 7 1 10 4 2 2 4 5 4 9a20 20 0 01-11 18l-9 3c-4 0-8-2-10-4-3-2-4-5-4-9zm21-26a25 25 0 00-22 13c-3 4-4 8-4 13s2 9 5 13c3 3 8 4 13 4s9-1 13-3 7-5 9-9c3-4 4-8 4-13 0-6-2-10-5-13s-8-5-13-5zm29 26a8 8 0 018-7l4 1 1 3-1 3-3 17h5l3-18 1-3-2-5c-2-2-4-2-6-2-4 0-7 1-9 4v-4h-4l-5 28h5zm32-30l-9 47h5l8-47zm5 19l7 24-11 17h6l25-41h-6l-11 19-5-19zm52 11c0 4-1 7-4 9-2 3-5 4-8 4l-5-2-2-6v-2l1-1c0-3 1-5 3-6a10 10 0 0113-1l2 5zm-23 30l3-18c1 4 4 5 8 5 5 0 8-1 12-4 3-4 5-8 5-13 0-4-1-6-3-8-3-2-5-3-9-3s-7 1-10 5l1-5h-5l-7 41zm57-41l-1 5c0-2-1-3-3-4l-5-1c-4 0-8 1-12 4-3 4-5 8-5 13 0 4 1 6 4 8 2 2 4 3 8 3s7-1 10-5l-1 5h5l5-28zm-21 16c0-3 2-6 4-8 2-3 5-4 8-4l5 2 2 6c0 3-1 6-4 8-2 3-5 4-7 4l-5-2c-2-1-3-3-3-6zm33 2l-5 2 4 6c2 2 4 2 6 2 4 0 6 0 8-2 2-1 4-4 4-6 0-4-3-6-7-8l-4-2-2-3 2-2 3-1c3 0 5 1 6 3l4-2c0-2-2-3-3-4l-7-1c-2 0-5 0-7 2-2 1-2 3-2 5v3l2 2 2 2 2 1 3 1 2 2v2l-1 3-4 1-4-2c-2-1-2-2-2-4zm24 0l-4 2c0 3 1 4 3 6s4 2 7 2 6 0 8-2c2-1 3-4 3-6 0-4-2-6-6-8l-5-2-1-3 1-2 3-1c3 0 5 1 6 3l4-2c0-2-1-3-3-4l-6-1c-3 0-5 0-7 2-2 1-3 3-3 5v3l2 2a15 15 0 005 3l2 1 2 2 1 2-2 3-4 1-4-2-2-4z"/><path d="M0 45l45 45 45-45L45 0 0 45zm45 21L24 45h42L45 66z"/></svg>')},get logoIcon(){return e.raw('<svg xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="0 0 90 90"><defs/><defs><clipPath id="a"><path d="M0 0h90v90H0z"/></clipPath></defs><g clip-path="url(#a)"><path fill="#FF9400" d="M0 45l45 45 45-45L45 0 0 45zm45 21L24 45h42L45 66z"/></g></svg>')}},i={cookie:{clear(e){this.set({name:e,value:"0",expires:-1})},get(e){for(const t of document.cookie.split("&")){const[a,r]=t.split("=");if(a===e)return r}return null},set(e){if(!e.name||!e.value||!e.expires)return null;document.cookie=e.name+"="+e.value+";path=/;max-age="+e.expires+";samesite=strict"}},crypto:{browser(e){const t=e.browser+e.pin+e.cookie,a=i.getCharSum(t),r=CryptoJS.SHA3(t+a),o=Number(String(a).slice(0,3));return CryptoJS.enc.Base64.stringify(CryptoJS.PBKDF2(t,r,{keySize:196,iterations:o}))},encrypt:(e,t)=>String(CryptoJS.AES.encrypt(e,t||r.master)),decrypt(e,t){try{return CryptoJS.enc.Utf8.stringify(CryptoJS.AES.decrypt(e,t||r.master))}catch{return null}},secret(e,t){const a=CryptoJS.SHA3(e+r.iterations+t),o=Number(String(r.iterations).slice(0,3));return CryptoJS.enc.Base64.stringify(CryptoJS.PBKDF2(t,a,{keySize:256,iterations:o}))},password(e){const t=CryptoJS.SHA3(e+r.iterations),a=Number(String(r.iterations).slice(0,3));return CryptoJS.enc.Base64.stringify(CryptoJS.PBKDF2(r.master,t,{keySize:384,iterations:a}))},hash:e=>CryptoJS.enc.Base64.stringify(CryptoJS.SHA3(e))},getCharSum(e){let t=0;return String(e).split("").forEach((e=>{t+=e.charCodeAt()})),t},getPrint(){const e=document.createElement("canvas"),t="!@#$%^&*()AabBcdDeEfgGhHiIjJklLmMnNopqQrstuvwWxyz",a=e.getContext("2d");return a.textBaseline="top",a.font="14px 'Arial'",a.textBaseline="alphabetic",a.fillStyle="#c24a7a",a.fillRect(1,1,283,353),a.fillStyle="#87fa91",a.fillText(t,2,15),a.fillStyle="rgba(194, 190, 149, 0.7)",a.fillText(t,4,17),this.crypto.hash(e.toDataURL())},query:t=>e.raw(document.querySelector(t)),randomNumber:(e,t)=>Math.floor(Math.random()*(t-e))+e,randomString:e=>CryptoJS.enc.Hex.stringify(CryptoJS.lib.WordArray.random(e||128)),safeParse(e){try{return JSON.parse(e)}catch{return null}},select:t=>e.raw(document.getElementById(a.store[t]))||e.div,get uid(){return String.fromCharCode(Math.floor(26*Math.random())+97)+Math.random().toString(16).slice(2)+String.fromCharCode(Math.floor(26*Math.random())+97)}},n={box:{check:(a,r)=>e.div.names("checkbox").add([e.input.attr({type:"checkbox"}).id(a),e.label.attr({for:t.store[a]}).text(r)]),icon:(t,a)=>e.div.names("iconbox").add([t in s.icons&&s.icons[t],e.span.text(a)]),password(t,a){const r=d.show.modal.password(a),o=d.remove.entry(a);return e.div.names("pwdbox").add([e.h2.text(t.replace(d.regHttp,"")).click(r),e.div.add([e.div.add([s.icons.slider,e.p.text("Config")]).click(r),e.div.add([s.icons.trash,e.p.text("Delete")]).click(o)])])},top:()=>e.div.names("top").add([s.logo.navigate("/"),e.div.names("row").add([s.icons.moon.id(c.moon).click(d.show.theme).hide(!d.isDark),s.icons.sun.id(c.sun).click(d.show.theme).hide(d.isDark),s.icons.lock.click(d.state.lock),s.icons.logout.click(d.state.logout)])])},modal:{port(t){const a=i.uid,r=t?d.util.import(a):d.util.copy(c.portfield),o=["Export your encrypted ledger data. No derived passwords are ever saved, only custom passwords get saved in your encrypted ledger.","Import ledger from a previous session. Ledger must match your current session data."];return p.add(e.div.id(a).names("overlay").add([e.div.names("modal").add(e.h2.text(t?"Import Ledger":"Export Ledger")).add(e.p.text(t?o[1]:o[0])).add(e.textarea.id(c.portfield)).add(e.div.add([e.button.text(t?"Import":"Copy").click(r),e.button.text("Cancel").click(d.remove.modal(a))]))]))},password(){const t=i.uid,a=["type","size"].map((t=>e.select.id(c["p"+t]).on("change",d.password.generate).add(o[t].map((t=>e.option.value(t[1]).text(t[0]))))));return p.add(e.div.id(t).names("overlay").add([e.div.names("modal").add(r.ledger[r.focus.hash].c?null:a).add(e.input.id(c.pvalue).attr({type:"text",readonly:1,placeholder:"Generated Password"})).add([e.div.add([e.button.text("Copy").click(d.util.copy(c.pvalue)),e.button.text("Close").click(d.remove.modal(t))])])]))}},option:{bar:()=>e.div.names("row options").add([n.box.icon("plus","New Password").id(c.oadd).click(d.show.option(c.optionadd)),n.box.icon("export","Export Ledger").click(d.show.modal.port()),n.box.icon("import","Import Ledger").click(d.show.modal.port(!0))]),add:()=>e.div.id(c.optionadd).names("option hide").add([e.input.id(c.addwebsite).attr({type:"text",placeholder:"Password identifier"}),e.input.id(c.addpwd).attr({type:"text",placeholder:"Custom password"}),e.p.text("Setting a custom password will override derived passwords. Custom passwords are only saved per session and can not be derived, only imported from an exported ledger."),e.button.text("Save Entry").click(d.password.add)]),questions:()=>o.questions.map(((t,a)=>e.option.value(a).text(t)))},footer:()=>e.footer.add([e.p.add([e.span.text("Made with "),e.span.names("color").html("&hearts;"),e.span.text(" by Reheem")])]),message:t=>e.div.names("message").text(t)},l={get copy(){return{auth:{title:"Account Recovery",intro:"The values entered below must never change, only enter values you'll never forget. Changing just one character will cause all derived passwords to be different.",phrase:"Select a password, phrase or any string of text which is personal and unforgettable to you. This can be a personal affirmation, mantra or anything else. Must be at least 8 characters.",pin:"Select a series of five or more numbers you'll never forget. Use numbers like your social security number, important birthdate or anything else."}}},authorize(t){return e.main.names("auth").add([n.box.top(),e.div.names("wrap col").add([e.h2.text(this.copy.auth.title),e.div.id(c.fullentropy).add([e.p.text(this.copy.auth.intro),e.select.id(c.equestion).add(n.option.questions()),e.input.id(c.eanswer).attr({type:"text",placeholder:"Your answer"}),e.p.text(this.copy.auth.phrase),e.input.id(c.ephrase).attr({type:"text",placeholder:"Your secret text"})]).hide(t),e.p.text(this.copy.auth.pin),e.input.id(c.epin).attr({type:"text",placeholder:"Your pin",pattern:"[0-9]"}),e.button.text("Unlock").id(c.ebutton).click(d.state[t?"unlock":"restore"])]),n.footer()])},manager:()=>e.main.add([s.icons.top.id(c.scrolltop).names("scrolltop").hide().click(d.util.scrollTop),n.box.top(),e.div.names("wrap col").add([e.input.attr({type:"search",placeholder:"Search websites"}).id(c.search).on("focus",d.util.hideOptions).on("input",d.search.init),n.option.bar(),n.option.add(),e.div.id(c.searchholder).names("container").hide().on("pointerdown",d.show.scroll).on("pointerup",d.show.scroll),e.div.id(c.pwdholder).names("container").on("pointerdown",d.show.scroll).on("pointerup",d.show.scroll)]),n.footer()])},d={password:{add(t){const a=e.raw(t.target);a.text("Saving...").attr({disabled:!0});const o=h(c.addwebsite),s=h(c.addpwd);if(!o.element.value)return void a.text("Try Again").attr({disabled:!1});const l=i.crypto.hash(o.element.value),p=i.uid;r.ledger[l]?a.text("Exists, try again").attr({disabled:!1}):(r.ledger[l]={n:o.element.value,c:s.element.value||null},r.locators[p]=l,h(c.pwdholder).insert(n.box.password(o.element.value,p).id(p)),d.state.save(),a.text("Entry Saved!"),o.value(),s.value(),setTimeout((()=>{a.text("Save Entry").attr({disabled:!1})}),2e3))},create(){let e=2===r.focus.type,t=1===r.focus.type,a=Number(r.focus.size),o=i.crypto.password(r.focus.hash),s=o.replace(d.regNonLetters,""),n=o.replace(d.regNonAlphaNum,""),l=a+r.focus.type;if(t)return s.slice(l,l+a);if(e){let e=n.slice(l,l+a),t=l;for(;((null===(c=e.match(d.regOnlyNums))||void 0===c?void 0:c.length)||0)<2;){var c;e=n.slice(t+=a,t+a),t+a>n.length&&(t=0)}return e}let p=r.specials.length,h="",u=a/4+1,m=0,g=0,w=2;for(;++m<=a;)l===p&&(l=0),g++%8==0&&(w+=1),m%w==0&&--u>0?h+=r.specials[997*o.charCodeAt(++l)%p]:h+=o[++l];return h},generate(){const e=h(c.ptype).element.value,t=h(c.psize).element.value,a=h(c.pvalue),o=r.focus.hash;r.ledger[o].c?a.value(r.ledger[o].c):0!=e&&0!=t&&(r.focus.type=Number(e),r.focus.size=Number(t),a.value(d.password.create()))}},state:{clear(){localStorage.removeItem(d.sessionKey),localStorage.removeItem(d.themeKey),i.cookie.clear(d.cookieKey)},lock(){window.location.reload()},logout(){d.state.clear(),window.location.reload()},restore(){h(c.ebutton).text("Decrypting account data...").attr({disabled:!0});const e=i.getPrint(),t=h(c.epin);if(d.util.getAnswer(t,5,!0))return void h(c.ebutton).text("Unlock").attr({disabled:!1});const a=i.cookie.get(d.cookieKey)||"",o=i.crypto.browser({browser:e,pin:t.element.value,cookie:a}),s=i.safeParse(i.crypto.decrypt(r.sessionData,o));if(!s||s.browser!==e)return d.util.message("There was an error decrypting your data."),localStorage.removeItem(d.sessionKey),i.cookie.clear(d.cookieKey),h(c.ebutton).text("Unlock").attr({disabled:!1}).click(d.state.unlock),void h(c.fullentropy).show();Object.assign(r,s),p.clear().add(l.manager()),d.util.getLedger(),d.util.getSpecials(t.element.value.length)},save(){localStorage.setItem(d.ledgerKey,i.crypto.encrypt(JSON.stringify(r.ledger)))},unlock(){const e=h(c.ebutton);e.text("Creating master key...").attr({disabled:!0});const t=h(c.equestion),a=h(c.eanswer),o=h(c.ephrase),s=h(c.epin);if(d.util.getAnswer(t,1,!0,!0)||d.util.getAnswer(a,3)||d.util.getAnswer(o,8)||d.util.getAnswer(s,5,!0))return void e.text("Unlock").attr({disabled:!1});const n=a.element.value,u=s.element.value,m=o.element.value,g=String(n+m+u);r.iterations=g.length*Number(t.element.value)*97,r.master=i.crypto.secret(u,i.crypto.browser({browser:n,pin:u,cookie:m})),r.browser=i.getPrint();const w=i.randomString(),v=i.crypto.browser({browser:r.browser,pin:u,cookie:w}),y=JSON.stringify({master:r.master,iterations:r.iterations,browser:r.browser});localStorage.setItem(d.sessionKey,i.crypto.encrypt(y,v)),i.cookie.set({name:d.cookieKey,value:w,expires:d.sessionTime}),p.clear().add(l.manager()),d.util.getLedger(),d.util.getSpecials(s.element.value.length)}},util:{copy:t=>function(t){const a=e.raw(t.target);a.text("Copied"),navigator.clipboard.writeText(h(this).element.value),setTimeout((()=>a.text("Copy")),2500)}.bind(t),fullScreen(){window.matchMedia("(display-mode: fullscreen)").matches&&document.documentElement.requestFullscreen({navigationUI:"hide"}).then({}).catch({}),window.removeEventListener("pointerdown",d.util.fullScreen)},getAnswer(e,t,a,r){let o=String(e.element.value),s=null;return r&&0==o&&(d.util.message("You must select a question from the list."),s=!0),o.length<t&&(d.util.message("Value must contain at least "+t+" characters."),s=!0),a&&d.regNums.test(o)&&(d.util.message("Value must contain only numerical characters."),s=!0),s&&(e.style({border:"2px solid var(--focus)"}),setTimeout((()=>e.style({borderColor:"transparent"})),d.messageTime)),s},getLedger(){const e=i.safeParse(i.crypto.decrypt(localStorage.getItem(d.ledgerKey)));e?(Object.assign(r.ledger,e),Object.keys(r.ledger).forEach((e=>{const t=r.ledger[e],a=i.uid;r.locators[a]=e,h(c.pwdholder).insert(n.box.password(t.n,a).id(a))}))):localStorage.removeItem(d.ledgerKey)},getSpecials(e){r.specials=Array(e).fill("!@#$%^&*()_-=+?|").join("")},hideOptions(){h(c.optionadd).names("option hide")},import:t=>function(t){const a=h(c.portfield).element.value,o=e.raw(t.target);if(!a)return void o.flash("Paste data");h(this).remove();const s=i.safeParse(i.crypto.decrypt(a));s?(Object.keys(s).forEach((e=>{if(e in r.ledger)return;const t=s[e],a=i.uid;r.locators[a]=e,h(c.pwdholder).insert(n.box.password(t.n,a).id(a))})),Object.assign(r.ledger,s),d.state.save(),d.util.message("Import successful. Your ledgers have been merged and encrypted.")):d.util.message("Import failed. Data incompatible with your account.")}.bind(t),message(e){p.add(n.message(e).style({right:"-75%"},d.messageTime-600).remove(d.messageTime))},scrollTop(){document.body.scrollTo(0,0),window.scrollTo(0,0),h(c.scrolltop).hide()}},remove:{entry:t=>function(t){const a=e.raw(t.target),o=e.raw(a.element.querySelector("p")),s=r.locators[this];if(s){if(a.hasClass("confirm"))return delete r.ledger[s],delete r.locators[this],d.state.save(),void h(this).remove();a.names("confirm"),o.text("Confirm"),setTimeout((()=>void a.declass("confirm")||void o.text("Delete")),2e3)}else h(this).remove()}.bind(t),modal:e=>function(){r.focus={},h(this).remove()}.bind(e)},search:{init(){r.search=Date.now(),setTimeout(d.search.query,500)},query(){if(Date.now()-(r.search||0)<300)return void(r.searching=!1);if(r.searching)return;r.searching=!0;const e=document.createDocumentFragment(),t=h(c.search).element.value||"";if(t.length<2)return h(c.pwdholder).show(),h(c.searchholder).hide(),void(r.searching=!1);Object.keys(r.locators).forEach((a=>{const o=r.locators[a],s=r.ledger[o];return!s||-1===s.n.indexOf(t)||void e.appendChild(n.box.password(s.n,a).element)})),e.firstChild?(h(c.pwdholder).hide(),h(c.searchholder).clear().show().element.appendChild(e),r.searching=!1):r.searching=!1}},show:{modal:{password:e=>function(){r.focus.hash=r.locators[this],d.util.hideOptions(),n.modal.password(),d.password.generate()}.bind(e),port:e=>function(){return d.util.hideOptions(),n.modal.port(this.isImport),this.isImport?null:void h(c.portfield).value(localStorage.getItem(d.ledgerKey))}.bind({isImport:e})},option:e=>function(){h(this).toggle("hide")}.bind(e),scroll(){const e=h(c.pwdholder).element.getBoundingClientRect();h(c.scrolltop).show().hide(e.top<0)},theme(){e.raw(document.body).toggle("dark").toggle("light"),!d.isDark&&h("moon").hide()&&h("sun").show(),d.isDark&&h("moon").show()&&h("sun").hide(),d.isDark=!d.isDark,localStorage.setItem(d.themeKey,d.isDark?"dark":"light")}}},c=new Proxy({},{get:(e,t)=>t}),p=e.div,h=i.select;i.query;d.regHttp=/^(http[s]?:\/\/)/,d.regNums=/[^0-9]/,d.regLetters=/[a-z]/gi,d.regOnlyNums=/[0-9]/g,d.regNonLetters=/[^a-z]/gi,d.regNonAlphaNum=/[^a-z0-9]/gi,d.messageTime=2500,d.sessionTime=604800,d.sessionKey="onlypass_session_data",d.ledgerKey="onlypass_ledger_data",d.cookieKey="onlypass_cookie",d.themeKey="onlypass_theme",d.isDark="light"!==localStorage.getItem(d.themeKey),r.sessionData=localStorage.getItem(d.sessionKey),r.ledger={},r.locators={},r.focus={},e.raw(document.body).add(p).names(d.isDark?"dark":"light"),p.add(l.authorize(!Boolean(r.sessionData))),window.addEventListener("pointerdown",d.util.fullScreen),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("./app.worker.js")}));
